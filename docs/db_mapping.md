# Input → DB 対応表（db_mapping.md / Version 1.0）

このドキュメントは、Input シートの各セルが  
DB シートのどの列に対応しているかをまとめたものです。

日報記録システムの整合性を保つための基礎資料として使用します。

---

## 1. Input → DB 対応表（商品／半製品 共通）

| Input（セル） | 内容 | DB列 | 備考 |
|---------------|------|------|------|
| B2 | 作業日 | 2 | 日付形式 |
| B3 | 種類（商品／半製品） | 1 | 文字列 |
| B24 | 準備時間 | 10 | 数値 |
| B25 | 主作業時間 | 11 | 数値 |
| B26 | 掃除時間 | 12 | 数値 |
| B31 | 評価理由 | 16 | 任意 |
| B32 | 工程メモ | 17 | 任意 |
| B33 | 中分類メモ | 18 | 任意 |
| B34 | 種類メモ | 19 | 任意 |
| B35 | 備考 | 20 | 任意 |
| （自動） | 登録日時 | 21 | Now() |
| （自動） | 未完了フラグ | 22 | 未完 or 空欄 |

---

## 2. 商品モード（B3 = "商品"）

### 2.1 Input → DB 対応

| Input（セル） | 内容 | DB列 | 備考 |
|---------------|------|------|------|
| B8 | 商品名 | 3 | 文字列 |
| A15〜C19 | 工程チェックボックス | 4 | 複数工程を文字列化（例：`内容ラベル貼り・詰め作業・熱処理`） |
| B23 | 数量 | 5 | 数値 |
| C23 | 単位 | 6 | 文字列 |
| （空欄） | 枚数 | 7 | 商品は未使用 |
| （空欄） | ロット | 8 | 商品は未使用 |
| （空欄） | 平均重量 | 9 | 商品は未使用 |
| （空欄） | 歩留まり | 13 | 商品は未使用 |
| （空欄） | 歩留り評価 | 14 | 商品は未使用 |
| （手動 or 空欄） | 時間評価 | 15 | 商品は標準比較なし |

---

## 3. 半製品モード（B3 = "半製品"）

### 3.1 Input → DB 対応

| Input（セル） | 内容 | DB列 | 備考 |
|---------------|------|------|------|
| B9 | 半製品名 | 3 | 文字列 |
| B21 | 工程（単一） | 4 | 1つのみ |
| B23 | 数量 | 5 | 数値 |
| C23 | 単位 | 6 | 文字列 |
| D23 | 枚数 | 7 | 必要に応じて |
| B22 | ロット | 8 | 日付 or 文字列 |
| B29 | 平均重量 | 9 | 数値 |
| （自動） | 歩留まり | 13 | 計算結果 |
| （自動） | 歩留り評価 | 14 | ○/× |
| （自動） | 時間評価 | 15 | 標準比較ロジック |

---

## 4. 作業者（チェックボックス → 文字列化）

### 4.1 Input → DB 対応

| Input（セル） | 内容 | DB列 | 備考 |
|---------------|------|------|------|
| B10〜D11 | 作業者チェックボックス | 17〜20 ではなく、DB には **文字列として 3列目 or メモ列に保存** | 例：`ササモト、マセ、オオタニ` |

※ 作業者は DB の固定列ではなく、  
　**名称の補足 or メモ列に保存する運用**（あなたの仕様に合わせる）

---

## 5. 工程（チェックボックス → 文字列化）

### 商品モード  
- 複数工程を「・」で連結  
- 例：  
内容ラベル貼り・詰め作業・熱処理

### 半製品モード  
- B21 の単一工程をそのまま DB4列へ

---

## 6. 数量表示（履歴用）

履歴スライドでは以下の形式に整形：
数量 / 単位 / 歩留まり%

例：
100 個 / 95%

---

## 7. DB 登録時の自動処理

| 項目 | 内容 |
|------|------|
| 登録日時 | Now() |
| 未完了フラグ | 空欄 or "未完" |
| 時間評価 | 半製品のみ自動判定 |
| 歩留り評価 | 半製品のみ自動判定 |

---

## 8. 備考

- 商品と半製品で DB に入る項目が大きく異なる  
- 工程と作業者は文字列化して保存  
- 修正モードでは Z1 に DB行番号を保持  
- 未完了呼び出しも同じ復元ロジックを使用

---

## 9. 更新履歴

- Version 1.0：初版作成（2026-01-28）
