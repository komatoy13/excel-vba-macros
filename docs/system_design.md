# Input シート 設計図（最新版）

本ドキュメントは、Input シートの動作仕様を定義する。  
作業区分・工程・大分類・中分類・詳分類・名称・単位・ロック制御・自動入力ロジックを完全に記述する。

---

# 1. 作業区分（B3）

## 1.1 製品
| 項目 | 動作 |
|------|------|
| B5（工程） | **常にグレーアウト（使用しない）** |
| B6（大分類） | T商品名テーブルの **中分類** |
| B7（中分類） | B6 に対応する **小分類** |
| B8（詳分類） | **常に入力可（プルダウンなし）** |
| B9（名称） | T商品名テーブルの **商品名** |

---

## 1.2 半製品
- B5（工程）を選択する
- B6/B7/B8 は工程に応じて変化（後述）

---

# 2. 工程（B5）ごとの挙動（半製品）

## 2.1 成型
- B6：形状（プルダウン）
- B7：色（プルダウン）
- B8：入力可
- 名称：種類

---

## 2.2 検品
- 半製品マスタでは **成型として扱う**
- B6：形状
- B7：色
- 名称：種類

---

## 2.3 プリント（特別仕様）
- B6：形状
- B7：プリント列（プルダウン）
- B8：色（プルダウン）
- 名称：種類

---

## 2.4 個包装
- B6：形状
- B7：色
- 名称：種類
- B23（平均重量）＝型d判定あり  
  - 判定キー：  
    - `B6 & "個包装"`  
    - `B6 & "_個包装"`

---

## 2.5 包装糖
- B6：形状
- B7：**グレーアウト**
- 名称：種類（形状のみで決定）

---

## 2.6 カット・検品
- 半製品マスタでは **包装糖として扱う**
- B6：形状
- B7：**グレーアウト**
- 名称：種類（形状のみで決定）

---

## 2.7 メレンゲ
- B6：形状
- B7：**グレーアウト**
- 名称：種類（形状のみで決定）

---

## 2.8 着色
- B6：形状
- B7：**グレーアウト**
- 名称：種類（形状のみで決定）

---

## 2.9 デコ（新規）
- B6：形状
- B7：色
- 名称：種類

---

## 2.10 箱折
- B6：形状
- B7：**グレーアウト**
- 名称：種類（形状のみで決定）

---

## 2.11 LS
- B6：形状
- B7：**グレーアウト**（箱折と同じ扱い）
- 名称：種類

---

## 2.12 LS個包装
- B6：形状
- B7：分類（プルダウン）
- 名称：種類

---

## 2.13 例外工程（パッキン裁断・緩衝材裁断）
| 項目 | 動作 |
|------|------|
| B6 | **グレーアウト** |
| B7 | **グレーアウト** |
| B8 | 入力可 |
| 名称 | 工程名をそのままセット |

---

# 3. 作業コード（B4）

## 3.1 入力した場合
### 製品
- T商品名テーブルから  
  - 中分類  
  - 小分類  
  - 商品名  
  をセット

### 半製品
- 半製品マスタから  
  - 工程  
  - 形状  
  - 色 or プリント  
  - 種類  
  をセット

### ロック
- B3/B5/B6/B7 → 白ロック
- B8 → 常に入力可
- B9 → 常にロック

---

## 3.2 空欄の場合（手入力モード）
- B5〜B8 の入力内容から名称（B9）を自動決定
- **グレーアウトしている項目は「入力済み」とみなす**

### 名称決定ロジック
#### 製品
- B6（中分類）＋ B7（小分類） → 商品名

#### 半製品
- プリント：形状＋プリント＋色 → 種類  
- 包装糖・カット検品・メレンゲ・着色・箱折・LS：形状のみ → 種類  
- 通常：工程＋形状＋色 → 種類

---

# 4. 詳分類（B8）
- **常に入力可（ロックしない）**
- プルダウンがあるのは **プリント工程のみ（色列）**

---

# 5. 単位（C17）

| 工程 | 単位 |
|------|------|
| 製品 | 個 |
| 成型・検品・LS | ㎏ |
| プリント・デコ | 粒 |
| 包装糖・カット検品 | 玉 |
| メレンゲ・着色 | g |
| 個包装・LS個包装 | 包 |
| 箱折 | 箱 |
| パッキン裁断・緩衝材裁断 | 枚 |

---

# 6. B18 / B19 / B23 の制御

## B18（枚数）
- 成型のときだけ入力可

## B19（ロット）
- 製品 → 入力可
- 半製品 → 工程により可否が変わる（現行仕様）

## B23（平均重量）
### 判定対象工程
- 検品  
- プリント  
- 個包装（特別）

### 判定方法
- 検品 → B6（形状）  
- プリント → B6（形状）  
- 個包装 →  
  - `B6 & "個包装"`  
  - `B6 & "_個包装"`  
- 型dテーブルで「検品時計量 = 1」なら入力可

---

# 7. ロック仕様まとめ

## 製品
| 項目 | 動作 |
|------|------|
| B5 | グレーアウト |
| B6/B7 | コード入力後は白ロック |
| B8 | 常に入力可 |
| B9 | 常にロック |

## 半製品
| 項目 | 動作 |
|------|------|
| B3/B5/B6/B7 | コード入力後は白ロック |
| B8 | 常に入力可 |
| 例外工程 | B6/B7 グレーアウト |

---

# 8. 例外処理まとめ

- パッキン裁断・緩衝材裁断は  
  - B6/B7 グレーアウト  
  - 名称は工程名固定  
- カット検品は包装糖扱い  
- 検品は成型扱い  
- LS は箱折扱い  

---

# 9. 今後の拡張性

- 工程追加時は  
  - B6/B7 の連動  
  - 名称決定ロジック  
  - 単位  
  を追加すれば対応可能。

---

# 以上
