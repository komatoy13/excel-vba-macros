# Input シート 設計図（最新版）

本ドキュメントは、Input シートの動作仕様を定義する。  
作業区分・工程・大分類・中分類・詳分類・名称・単位・ロック制御・自動入力ロジックを完全に記述する。

---

# 1. 作業区分（B3）

## 1.1 製品
- B5（工程）＝常にグレーアウト
- B6（大分類）＝T商品名「中分類」
- B7（中分類）＝B6 に対応する「小分類」
- B8（詳分類）＝常に入力可
- B9（名称）＝T商品名「商品名」
- B12〜C15（製品工程チェック）＝製品時のみ使用  
  → 半製品時はグレーアウト

## 1.2 半製品
- B5（工程）を選択
- B6/B7/B8 は工程に応じて変化
- B12〜C15（製品工程チェック）＝常にグレーアウト

---

# 2. 工程（B5）ごとの挙動（半製品）

（※省略：前回の system_design.md と同一。成型・検品・プリント・個包装・包装糖・カット検品・メレンゲ・着色・デコ・箱折・LS・LS個包装・例外工程の仕様は変更なし）

---

# 3. 作業コード（B4）

- 入力あり → 製品 or 半製品マスタから全項目セット
- 入力なし → 手入力モード（名称自動決定）
- グレーアウト項目は「入力済み」とみなす

---

# 4. 詳分類（B8）
- 常に入力可
- プリント工程のみプルダウンあり

---

# 5. 単位（C17）
（※前回と同一）

---

# 6. B18 / B19 / B23 の制御
（※前回と同一）

---

# 7. ロック仕様まとめ

## 常にアンロックするセル
- B2（作業日）
- B17
- B20
- B21
- B22
- B25〜B31
- D2（スピンボタンリンクセル）

---

# 8. 製品工程チェック（B12〜C15）

## 製品の場合
- T商品名テーブルの「工程列」を参照  
- 数字が入っている工程 → チェックON  
- 数字がない工程 → チェックOFF＋薄色

## 半製品の場合
- 全てグレーアウト（操作不可）

---

# 9. ロット自動生成（製品）

日付：YYYY/MM/DD  
ロット：  
- 年の10の位 → A=1, B=2…  
- 年の1の位 → A=1, B=2…  
- 月 → A=1, B=2…  
- 日 → 2桁数字

例：2026/2/5 → BFB05  
例：2030/11/20 → CKL20

---

# 10. 賞味期限（C19）

- 中分類が「和の糖」「ラグジュアリー○○」のときのみ入力可
- それ以外はグレーアウト

---

# 以上
